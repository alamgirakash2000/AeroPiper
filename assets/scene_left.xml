<mujoco model="arm_hand_scene">
  <compiler angle="radian" meshdir="combined_arm_hand/assets"/>
  <option integrator="implicitfast" cone="elliptic" impratio="10" timestep="0.01">
    <flag eulerdamp="disable" />
  </option>
  <custom>
    <numeric data="30" name="max_contact_points" />
    <numeric data="12" name="max_geom_pairs" />
  </custom>
  <statistic center="0 0 0.6" extent="0.5"/>  <!-- Focus on table top -->
  <visual>
    <headlight diffuse="0.6 0.6 0.6" ambient="0.3 0.3 0.3" specular="0 0 0"/>
    <rgba haze="0.9 0.9 0.9 1"/>  <!-- Light gray haze for background -->
    <global azimuth="90" elevation="-50"/>  <!-- Higher camera angle focusing on table -->
  </visual>
  <asset>
    <texture type="skybox" builtin="gradient" rgb1="0.9 0.9 0.9" rgb2="0.9 0.9 0.9" width="512" height="3072"/>  <!-- Solid light gray skybox -->

    <!-- Light wooden floor -->
    <texture type="2d" name="groundplane" builtin="checker" rgb1="0.314 0.298 0.294" rgb2="0.788 0.765 0.741" width="512" height="512" mark="none"/>
    <material name="groundplane" texture="groundplane" texuniform="true" texrepeat="1 10" reflectance="0.0" shininess="0.2"/>

    <!-- White table top -->
    <material name="table_material" rgba="1 1 1 1" specular="0.5" shininess="0.3" reflectance="0.2"/>

    <!-- Solid light gray wall -->
    <material name="wall_material" rgba="0.9 0.9 0.9 1" shininess="0.0" reflectance="0.0"/>
  </asset>
  <include file="aero_piper_left.xml"/>
  <worldbody>
    <light pos="0 0 1.5" dir="0 0 -1" directional="true"/>
    <geom name="floor" size="0 0 0.05" type="plane" material="groundplane"/>
    
    <!-- Updated: Larger table, centered for better arm placement -->
    <body name="table" pos="0 0 0.6">  <!-- Lowered height -->
      <geom name="table_top" type="box" size="0.5 0.5 0.025" material="table_material" contype="1" conaffinity="1" friction="1 0.005 0.0001"/>  <!-- Smaller size -->

      <body name="leg1" pos="0.45 0.45 -0.3">  <!-- Adjusted for smaller table, lowered -->
        <geom type="cylinder" size="0.05 0.3" rgba="0.5 0.5 0.5 1"/>
      </body>
      <body name="leg2" pos="0.45 -0.45 -0.3">
        <geom type="cylinder" size="0.05 0.3" rgba="0.5 0.5 0.5 1"/>
      </body>
      <body name="leg3" pos="-0.45 0.45 -0.3">
        <geom type="cylinder" size="0.05 0.3" rgba="0.5 0.5 0.5 1"/>
      </body>
      <body name="leg4" pos="-0.45 -0.45 -0.3">
        <geom type="cylinder" size="0.05 0.3" rgba="0.5 0.5 0.5 1"/>
      </body>

      <!-- New: Mount the robot arm on the table (slightly above the top surface) -->
      <body name="arm_mount" pos="-0.4 0 0.03">  <!-- Positioned to one side; adjust for your setup -->
        <!-- Robot will be attached here using attach element below -->
      </body>
    </body>
    
    <!-- Updated: Walls farther apart, only two sides (left and right, no back) -->
    <geom name="left_wall" type="box" pos="2.0 0 1.0" size="0.02 3.0 1.0" material="wall_material" contype="0" conaffinity="0"/>  <!-- Left wall -->
    <!-- <geom name="back_wall" type="box" pos="0 -2.0 1.0" size="2.0 0.02 1.0" material="wall_material" contype="0" conaffinity="0"/>  Back wall for background -->
    
    <!-- Small cubes on table for visual match -->
    <body pos="0 0 0.63" name="green_cube">  <!-- Adjusted for new table height -->
      <geom type="box" size="0.01 0.01 0.01" rgba="0 1 0 1"/>
    </body>
    <body pos="0.02 0 0.63" name="red_cube">
      <geom type="box" size="0.01 0.01 0.01" rgba="1 0 0 1"/>
    </body>
    
  </worldbody>
  
  <equality>
    <!-- Weld the robot base to the table mount -->
    <weld body1="arm_mount" body2="left_base_link" solref="0.02 1"/>
  </equality>
  
  <keyframe>
  </keyframe>
</mujoco>